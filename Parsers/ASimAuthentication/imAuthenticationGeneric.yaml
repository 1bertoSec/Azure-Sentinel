Parser:
  Title: ASIM Source Agnostic Authentication Parser
  Version: '0.0'
  LastUpdated: June 9, 2021
Product:
  Name: Microsoft Windows Events
Normalization:
  Schema: Authentication
  Version: '0.1.0'
References:
- Title: ASIM Authentication Schema
  Link: https://aka.ms/AzSentinelAuthenticationDoc
- Title: ASIM
  Link: https:/aka.ms/AzSentinelNormalization
Description: |
      This Query creates an empty table of the authentication schema.
ParserName: imAuthentication
ParserParams:
  - Name: starttime
    Type: datetime
    Default: datetime(null)
  - Name: endtime
    Type: datetime
    Default: datetime(null)
  - Name: targetusername_has
    Type: string
    Default: '*'
ParserQuery: |
  let imAuthentication=(starttime:datetime=datetime(null), endtime:datetime=datetime(null), targetusername_has:string="*"){
  union isfuzzy=true
  vimAuthenticationEmpty
    , vimAuthenticationAADManagedIdentitySignInLogs(starttime, endtime, targetusername_has)
    , vimAuthenticationAADNonInteractiveUserSignInLogs(starttime, endtime, targetusername_has)
    , vimAuthenticationAADServicePrincipalSignInLogs(starttime, endtime, targetusername_has)
    , vimAuthenticationSigninLogs(starttime, endtime, targetusername_has)
    , vimAuthenticationAWSCloudTrail(starttime, endtime, targetusername_has)
    , vimAuthenticationOktaSSO(starttime, endtime, targetusername_has)
    , vimAuthenticationWindowsSecurityEvent(starttime, endtime, targetusername_has)
    , vimAuthenticationM365Defender(starttime, endtime, targetusername_has)
    , vimAuthenticationMicrosoftWindowsEvent(starttime, endtime, targetusername_has)
    , vimAuthenticationMD4IoT(starttime, endtime, targetusername_has)
    };
    imAuthentication(starttime, endtime, targetusername_has)
